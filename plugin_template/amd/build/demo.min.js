define(["mod_vuestest/vue","mod_vuestest/axios"],function(e){"use strict";return{init:function(){new e({delimiters:["[[","]]"],el:"#app",data:{message:"Binded message",count:0,user:"",pw:"",token:"",loggedIn:!1,courses:[],camundaMessage:""},mounted:function(){this.checkLoginToken()},methods:{getToken:function(){var e=require("mod_vuestest/axios"),s=this;console.log(s),e.get("/login/token.php",{params:{username:this.user,password:this.pw,service:"moodle_mobile_app"}}).then(function(e){console.log(e);var t=new Date;t.setTime(t.getTime()+864e5);var o="expires="+t.toUTCString();document.cookie="wstoken="+e.data.token+";"+o+";path=/",s.checkLoginToken()}).catch(function(e){console.log(e)})},getCourses:function(){var e=require("mod_vuestest/axios"),t=this;t.token;e.get("/webservice/rest/server.php",{params:{wstoken:t.token,wsfunction:"core_course_get_courses",moodlewsrestformat:"json"}},{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){e.data.exception||(t.courses=e.data)}).catch(function(e){console.log(e)})},callCamunda:function(e){var t=require("mod_vuestest/axios"),o=this;t.post("http://localhost:8051/engine-rest/process-definition/key/"+e+"/start",{},{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){console.log(),o.camundaMessage="Process started with id: "+e.data.id}).catch(function(e){o.camundaMessage=e.message})},checkLoginToken:function(){for(var e=document.cookie.split(";"),t=!1,o=0;o<e.length;o++)"wstoken"==e[o].substring(1,8)&&(t=!0,this.loggedIn=!0,this.token=e[o].substring(9));t||(this.loggedIn=!1)}}})}}});
